on:
  pull_request:
    types: [ opened ]
  issue_comment:
    types: [ created ]

name: benchmark pull requests
jobs:
  runBenchmark:
    name: run benchmark
    runs-on: self-hosted
    steps:
      - uses: khan/pull-request-comment-trigger@master
        id: check_comment
        with:
          trigger: '@benchmark'
          reaction: rocket
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
      - uses: actions/checkout@master
        if: steps.check_comment.outputs.triggered == 'true'
      - uses: jasonwilliams/criterion-compare-action@move_to_actions
        if: steps.check_comment.outputs.triggered == 'true'
        with:
          benchName: "bench_storage bench_chain bench_state_tree bench_vm" # Optional. Compare only this benchmark target
          token: ${{ secrets.GITHUB_TOKEN }}